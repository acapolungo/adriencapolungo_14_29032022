<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: Table/EmployeeTable.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: Table/EmployeeTable.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React, { useMemo, useState } from 'react';
import { useSelector, useDispatch } from 'react-redux';
import { useTable, useSortBy, useGlobalFilter, usePagination, useRowSelect } from 'react-table/dist/react-table.development';

import '../Table/table.css';
import { HiChevronDoubleUp } from "react-icons/hi";
import { HiChevronDoubleDown } from "react-icons/hi";
import { FiEdit } from 'react-icons/fi';
import { RiSaveFill } from 'react-icons/ri';
import { MdDeleteForever } from 'react-icons/md';

import { COLUMNS } from './Columns';
import GlobalFilter from './GlobalFilter';
import { selectEmployee } from '../../utils/selectors';
import { deleteEmployee, updateEmployee } from '../../reducers/employeeSlice';

// Create an editable cell renderer
const EditableCell = ({
    value: initialValue,
    // row: { index, id },
    row: { index, original },
    column: { id: property },
    updateMyData, // This is a custom function that we supplied to our table instance
    editableRowIndex // index of the row we requested for editing
}) => {
    // We need to keep and update the state of the cell normally
    const [value, setValue] = useState(initialValue);

    const onChange = (e) => {
        setValue(e.target.value);
    };

    // We'll only update the external data when the input is blurred
    const onBlur = () => {
        updateMyData(original, property, value);
    };

    // If the initialValue is changed externall, sync it up with our state
    React.useEffect(() => {
        setValue(initialValue);
    }, [initialValue]);

    return index === editableRowIndex ? (
        &lt;input value={value} onChange={onChange} onBlur={onBlur} />
    ) : (
        &lt;p>{value}&lt;/p>
    );
};

// Set our editable cell renderer as the default Cell renderer
const defaultColumn = {
    Cell: EditableCell
};


/**
 * the Table display header and text, you can customize style
 * 
 * @param { array } columns
 * @param { array } data
 * @param { object } updateMyData
 * @param { object } handleDeleteEmployee
 * @return { Table }
 */
export function Table({ columns, data, updateMyData, handleDeleteEmployee }) {

    // Local state for editable row index for custom hooks
    const [editableRowIndex, setEditableRowIndex] = useState(null);
    const initialState = { hiddenColumns: ['id'] };

    // function to react table
    // const { getTableProps, getTableBodyProps, headerGroups, rows, prepareRow } = tableInstance
    // creating a table instance stored in a const, row for single page, pages for multiple page with rows
    const {
        getTableProps,
        getTableBodyProps,
        headerGroups,
        page,
        nextPage,
        previousPage,
        canNextPage,
        canPreviousPage,
        pageOptions,
        gotoPage,
        pageCount,
        setPageSize,
        prepareRow,
        state,
        setGlobalFilter,
    } = useTable({
        columns,
        data,
        initialState,
        defaultColumn,
        // updateMyData isn't part of the API, but anything we put into these options will
        // automatically be available on the instance.
        // That way we can call this function from our cell renderer!
        updateMyData,
        // pass state variables so that we can access them in edit hook later
        // setState hook for toggling edit on/off switch
        editableRowIndex,
        setEditableRowIndex
    },
        useGlobalFilter,
        useSortBy,
        usePagination,
        useRowSelect,
        hooks => {
            hooks.allColumns.push(columns => [
                // other hooks such as selection hook
                ...columns,
                // edit hook
                {
                    accessor: "Action",
                    id: "action",
                    // The header can use the table's getToggleAllRowsSelectedProps method
                    // to render a checkbox
                    Header: 'Action',
                    // The cell can use the individual row's getToggleRowSelectedProps method
                    Cell: ({ row, setEditableRowIndex, editableRowIndex }) => (
                        // handleEdit(row)
                        &lt;div>
                            &lt;button
                                className="action__btn"
                                onClick={() => {
                                    const currentIndex = row.index;
                                    if (editableRowIndex !== currentIndex) {
                                        // row requested for edit access
                                        setEditableRowIndex(currentIndex);
                                    } else {
                                        // request for saving the updated row
                                        setEditableRowIndex(null); // keep the row closed for edit after we finish updating it
                                    }
                                }}
                            >
                                {/* single action button supporting 2 modes */}
                                {editableRowIndex !== row.index ? &lt;FiEdit /> : &lt;RiSaveFill />}
                            &lt;/button>
                            &lt;MdDeleteForever className='table__delbtn' onClick={() => handleDeleteEmployee(row.original.id) } />
                        &lt;/div>),
                }
            ])
        }
    );

    // state local destructuré
    const { globalFilter } = state;
    const { pageIndex, pageSize } = state;

    return (
        &lt;>
            &lt;section className='table__contentnav'>
                &lt;div className="table__navcontainer">
                    {/* Select dropdown for Page size */}
                    &lt;select className="table__select" value={pageSize} onChange={e => setPageSize(Number(e.target.value))}>
                        {
                            [10, 25, 50].map(pageSize => (
                                &lt;option key={pageSize} value={pageSize} >
                                    Show {pageSize}
                                &lt;/option>
                            ))
                        }
                    &lt;/select>
                    &lt;GlobalFilter filter={globalFilter} setFilter={setGlobalFilter} />
                    &lt;span className='table__pagination'>
                        Page{''} &lt;strong>{pageIndex + 1} of {pageOptions.length}&lt;/strong>{''}
                    &lt;/span>
                    &lt;span>
                        | Go to page: {' '}
                        &lt;input className='table__number' type='number' defaultValue={pageIndex + 1} onChange={(e) => {
                            const pageNumber = e.target.value ? Number(e.target.value) - 1 : 0
                            gotoPage(pageNumber)
                        }}
                            style={{ width: '50px' }}
                        >&lt;/input>
                    &lt;/span>
                &lt;/div>
                &lt;div className="table__navcontainer">
                    &lt;button className='table__btn--goback' onClick={() => gotoPage(0)} disabled={!canPreviousPage}>{'&lt;&lt;'}&lt;/button>
                    &lt;button className='table__btn--previous' onClick={() => previousPage()} disabled={!canPreviousPage}>Previous&lt;/button>
                    &lt;button className='table__btn--next' onClick={() => nextPage()} disabled={!canNextPage}>Next&lt;/button>
                    &lt;button className='table__btn--gonext' onClick={() => gotoPage(pageCount - 1)} disabled={!canNextPage}>{'>>'}&lt;/button>
                &lt;/div>
            &lt;/section>

            &lt;table {...getTableProps()}>
                {/* Header section */}
                &lt;thead >
                    {
                        headerGroups.map((headerGroup) => (
                            &lt;tr {...headerGroup.getHeaderGroupProps()}>
                                {
                                    headerGroup.headers.map((column) => (
                                        &lt;th {...column.getHeaderProps(column.getSortByToggleProps())}>
                                            {column.render('Header')}
                                            &lt;span>
                                                {column.isSorted ? (column.isSortedDesc ? &lt;HiChevronDoubleDown /> : &lt;HiChevronDoubleUp />) : ''}
                                            &lt;/span>
                                        &lt;/th>

                                    ))
                                }
                            &lt;/tr>
                        ))}
                &lt;/thead>
                {/* Rows */}
                &lt;tbody {...getTableBodyProps()}>
                    {
                        // on remplace row par Page pour plusieur pages
                        page.map(row => {
                            prepareRow(row)
                            return (
                                &lt;tr {...row.getRowProps()}>
                                    {
                                        // return all individual td cell
                                        row.cells.map(cell => {
                                            return &lt;td {...cell.getCellProps()}>{cell.render('Cell')}&lt;/td>
                                        })
                                    }
                                &lt;/tr>
                            )
                        })
                    }
                &lt;/tbody>
            &lt;/table>
        &lt;/>
    )
}

// instance of Table
export function EmployeeTable({ openModal }) {

    // useMemo Hook the data ins't created on every render,
    // Pass them on argument into the useTabe Hook
    const dispatch = useDispatch();
    const columns = useMemo(() => COLUMNS, [])

    const updateMyData = (employee, property, value) => {
        const employeeCopy = { ...employee };
        employeeCopy[property] = value;
        dispatch(updateEmployee({ employeeCopy }))
        openModal('Vous avez mis à jour un employé')
    }

    const handleDeleteEmployee = (id) => {
        dispatch(deleteEmployee({ id }))
        openModal('Vous avez supprimé un employé')
    }

    return &lt;Table
        columns={columns}
        data={useSelector(selectEmployee)}
        updateMyData={updateMyData}
        handleDeleteEmployee={handleDeleteEmployee}
    />
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="module.html#.exports">exports</a></li></ul><h3>Global</h3><ul><li><a href="global.html#Modal">Modal</a></li><li><a href="global.html#Table">Table</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.10</a> on Wed Apr 06 2022 14:13:55 GMT+0200 (heure d’été d’Europe centrale)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
